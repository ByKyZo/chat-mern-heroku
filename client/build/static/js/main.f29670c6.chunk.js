(this["webpackJsonpchat-group-master"]=this["webpackJsonpchat-group-master"]||[]).push([[0],{132:function(e,t,n){},133:function(e,t,n){},285:function(e,t,n){},286:function(e,t,n){},287:function(e,t,n){},288:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n.n(c),s=n(114),a=n.n(s),l=(n(132),n(133),n(3)),i="",o=n(4),u=n(10),d=n(11),j=n(8),b=n.n(j),h=r.a.createContext(null),x=n(290),f=n(1),m=function(e){var t=e.isAlreadyMember,n=Object(x.a)(),r=Object(l.a)(n,2)[1],s=Object(c.useContext)(h).setUser,a=Object(c.useState)(!1),j=Object(l.a)(a,2),m=j[0],O=j[1],p=Object(c.useState)({email:"",password:""}),g=Object(l.a)(p,2),v=g[0],N=g[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h1",{className:"mb-8 text-4xl text-white uppercase",children:"Login"}),Object(f.jsxs)("form",{className:"w-full",noValidate:!0,onSubmit:function(e){e.preventDefault(),b.a.post("".concat(i,"user/signin"),v).then((function(e){if(""===e.status)throw new Error;O(!1),s({id:e.data._id,pseudo:e.data.pseudo,email:e.data.email,description:e.data.description,picture:i+e.data.picture,role:null,isConnected:!0,currentChannel:{},notifications:[]}),r(["REMEMBER_ME"],e.data.remember_me_token)})).catch((function(e){O(!0)}))},children:[Object(f.jsxs)("div",{className:"authInputWrapper mb-5",children:[Object(f.jsx)("label",{htmlFor:"emailLogin",className:"cursor-pointer",children:Object(f.jsx)(u.a,{className:"text-gray-600 text-2xl m-4",icon:d.b})}),Object(f.jsx)("input",{id:"emailLogin",type:"email",className:"authInput",placeholder:"Email",value:v.email,autoComplete:"on",onChange:function(e){return N(Object(o.a)(Object(o.a)({},v),{},{email:e.target.value}))}})]}),Object(f.jsxs)("div",{className:"authInputWrapper mb-5",children:[Object(f.jsx)("label",{htmlFor:"passwordLogin",className:"cursor-pointer",children:Object(f.jsx)(u.a,{className:"text-gray-600 text-2xl m-4 cursor-pointer",icon:d.c})}),Object(f.jsx)("input",{id:"passwordLogin",type:"password",className:"authInput",placeholder:"Password",value:v.password,onChange:function(e){return N(Object(o.a)(Object(o.a)({},v),{},{password:e.target.value}))}})]}),m&&Object(f.jsx)("p",{className:"text-red-400",children:"Email or password incorrect"}),Object(f.jsx)("button",{className:"authBtn w-full bg-blue-700 hover:bg-opacity-80",type:"submit",children:"Connexion"})]}),Object(f.jsx)("button",{className:"authBtn p-8 bg-green-700 hover:bg-opacity-80",onClick:function(){return t(!1)},children:"Register"})]})},O=n(127),p=n(25),g=n(120),v=function(e){var t=e.isAlreadyMember,n=e.setIsAlreadyMember,r=(e.setIsOpenPopupSuccess,Object(c.useState)(!1)),s=Object(l.a)(r,2),a=(s[0],s[1],Object(c.useContext)(h)),j=(a.user,a.setUser),x=Object(O.a)({initialValues:{pseudo:"",email:"",password:"",confirmPassword:""},validationSchema:p.a({pseudo:p.c().required("Required"),email:p.c().required("Email address is required").email("Invalid email address"),password:p.c().required("Password is required"),confirmPassword:p.c().required("Please confirm your password").oneOf([p.b("password"),null],"Password must matched")}),onSubmit:function(e){!function(e){b.a.post("".concat(i,"user/signup"),e).then((function(e){if(200!==e.status)throw new Error("ceci est une erreur");n(!0),j((function(e){return e.notifications.push({icons:Object(f.jsx)(g.a,{}),color:"green-500",label:"Sign Up Successful"}),Object(o.a)({},e)}))})).catch((function(e){console.log("ERROR ---- "+e.message)}))}({pseudo:e.pseudo,email:e.email,password:e.password})}});return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("h1",{className:"mb-8 text-4xl text-white uppercase",children:"Sign Up"}),Object(f.jsxs)("form",{onSubmit:x.handleSubmit,className:"w-full",autoComplete:"off",children:[Object(f.jsxs)("div",{className:"mb-5",children:[Object(f.jsxs)("div",{className:"authInputWrapper",children:[Object(f.jsx)("label",{htmlFor:"pseudo",className:"cursor-pointer",children:Object(f.jsx)(u.a,{icon:d.e,className:"text-gray-600 text-2xl m-4"})}),Object(f.jsx)("input",Object(o.a)({id:"pseudo",type:"text",className:"authInput",placeholder:"Full Name"},x.getFieldProps("pseudo")))]}),x.touched.pseudo&&x.errors.pseudo&&Object(f.jsx)("p",{className:"text-red-400",children:x.errors.pseudo})]}),Object(f.jsxs)("div",{className:"mb-5",children:[Object(f.jsxs)("div",{className:"authInputWrapper",children:[Object(f.jsx)("label",{htmlFor:"Email",className:"cursor-pointer",children:Object(f.jsx)(u.a,{icon:d.b,className:"text-gray-600 text-2xl m-4"})}),Object(f.jsx)("input",Object(o.a)({id:"Email",type:"text",className:"authInput",placeholder:"Email"},x.getFieldProps("email")))]}),x.touched.email&&x.errors.email&&Object(f.jsx)("p",{className:"text-red-400",children:x.errors.email})]}),Object(f.jsxs)("div",{className:"mb-5",children:[Object(f.jsxs)("div",{className:"authInputWrapper",children:[Object(f.jsx)("label",{htmlFor:"Password",className:"cursor-pointer",children:Object(f.jsx)(u.a,{icon:d.c,className:"text-gray-600 text-2xl m-4"})}),Object(f.jsx)("input",Object(o.a)({id:"Password",type:"password",className:"authInput",placeholder:"Password"},x.getFieldProps("password")))]}),x.touched.password&&x.errors.password&&Object(f.jsx)("p",{className:"text-red-400",children:x.errors.password})]}),Object(f.jsxs)("div",{className:"mb-5",children:[Object(f.jsxs)("div",{className:"authInputWrapper",children:[Object(f.jsx)("label",{htmlFor:"ConfirmPassword",className:"cursor-pointer",children:Object(f.jsx)(u.a,{icon:d.c,className:"text-gray-600 text-2xl m-4"})}),Object(f.jsx)("input",Object(o.a)({id:"ConfirmPassword",type:"password",className:"authInput",placeholder:"Confirm password"},x.getFieldProps("confirmPassword")))]}),x.touched.confirmPassword&&x.errors.confirmPassword&&Object(f.jsx)("p",{className:"text-red-400",children:x.errors.confirmPassword})]}),Object(f.jsx)("button",{className:"authBtn w-full bg-blue-700 hover:bg-opacity-80",type:"submit",children:"Sign Up"})]}),Object(f.jsx)("button",{className:"authBtn p-8 bg-green-700 hover:bg-opacity-80",onClick:function(){return t(!0)},children:"Connexion"})]})},N=function(e){var t=e.label,n=e.icons,r=e.color,s=e.isOpen,a=Object(c.useState)(0),i=Object(l.a)(a,2);i[0],i[1];return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("li",{className:"p-6 border-2 border-".concat(r," text-").concat(r," \n                            bg-gray-100 flex items-center rounded \n                            z-50 transition duration-500 transform ease-in-out translate-y-0 mb-2\n                            ").concat(s?"translate-y-0":"-transelate-y-full"),children:[Object(f.jsx)("div",{className:"text-2xl mr-4",children:n}),Object(f.jsx)("span",{className:"font-semibold",children:t})]})})},w=function(e){var t=Object(c.useState)(!0),n=Object(l.a)(t,2),r=n[0],s=n[1],a=Object(c.useState)(!1),i=Object(l.a)(a,2),o=(i[0],i[1]);return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)("div",{className:"p-8 rounded-xl flex flex-col items-center justify-center w-96 shadow-2xl border border-gray-700 bg-gray-800",children:r?Object(f.jsx)(m,{isAlreadyMember:s}):Object(f.jsx)(v,{isAlreadyMember:s,setIsAlreadyMember:s,setIsOpenPopupSuccess:o})})})},y=n(125),C=n(37),I=n.n(C),M=n(6),k=function(e){var t=e.children,n=e.isOpen,r=e.setIsOpen,s=e.text,a=Object(c.useRef)();return Object(c.useEffect)((function(){var e=n,t=function(t){a.current&&!a.current.contains(t.target)&&e&&r(!1)};return window.addEventListener("mousedown",t),function(){window.removeEventListener("mousedown",t)}}),[n]),Object(f.jsx)("div",{className:"absolute w-full h-full bg-black bg-opacity-50 transition z-50 duration-200 transform ".concat(n?"opacity-100 z-50":"opacity-0 pointer-events-none"," flex items-center justify-center"),children:Object(f.jsxs)("div",{ref:a,className:"text-white bg-black-1100 h-auto w-auto p-6 rounded-xl transition delay-75 duration-200 ease transform ".concat(n?"scale-100 opacity-100":"opacity-0 scale-0"),children:[s&&Object(f.jsx)("p",{className:"w-40 mb-4 text-center m-auto text-lg italic",children:s}),t]})})},F=n(121),E=n.n(F)()(""),_=Object(c.createContext)(),S=n(12),D=function(e){var t=e.isOpen,n=e.setIsOpen,r=(e.channels,e.addChannel),s=Object(c.useContext)(_),a=Object(c.useContext)(h),i=a.user,u=a.setUser,d=Object(c.useState)({userID:i.id,name:"",description:""}),j=Object(l.a)(d,2),b=j[0],x=j[1];return Object(c.useEffect)((function(){return s.on("createChannel",(function(e){var t=e.userID,c=e.channel;u((function(e){return e.notifications.push({icons:Object(f.jsx)(S.a,{}),color:"green-500",label:"Channel ".concat(c.name," create")}),Object(o.a)({},e)})),n(!1),x({userID:i.id,name:"",description:""}),t===i.id&&r((function(e){return[].concat(Object(M.a)(e),[c])}))})),function(){s.off("createChannel")}}),[]),Object(f.jsxs)(k,{isOpen:t,setIsOpen:n,children:[Object(f.jsx)("h4",{className:"text-white font-semibold mb-7",children:"NEW CHANNEL"}),Object(f.jsxs)("div",{children:[Object(f.jsx)("input",{className:"bg-InputCreateChannel rounded-md mb-5 p-2 w-full ctmFocus",type:"text",id:"",value:b.name,onChange:function(e){return x(Object(o.a)(Object(o.a)({},b),{},{name:e.target.value}))}}),Object(f.jsx)("textarea",{className:"bg-InputCreateChannel rounded-md mb-5 p-2  w-full h-24 resize-none ctmFocus leading-4",spellCheck:"false",value:b.description,onChange:function(e){return x(Object(o.a)(Object(o.a)({},b),{},{description:e.target.value}))}}),Object(f.jsx)("button",{className:"bg-blue-600 rounded-md py-1 px-6 text-white ctmFocus hover:bg-blue-700 float-right",onClick:function(){s.emit("createChannel",b)},children:"Save"})]})]})},P=(n(285),function(e){e.channels;var t=e.setChannels,n=Object(c.useState)(!1),r=Object(l.a)(n,2),s=r[0],a=r[1],j=Object(c.useState)([]),x=Object(l.a)(j,2),m=x[0],O=x[1],p=Object(c.useContext)(h),g=p.user,v=p.setUser,N=Object(c.useRef)(),w=Object(c.useRef)(),y=Object(c.useContext)(_),C=function(){b.a.get("".concat(i,"channel/search/").concat(g.id)).then((function(e){O(e.data)}))};Object(c.useEffect)((function(){return y.on("joinChannel",(function(e){var n=e.joinedUser,c=e.joinedChannel;v((function(e){return e.notifications.push({icons:Object(f.jsx)(S.a,{}),color:"green-500",label:"Channel ".concat(c.name," joined")}),Object(o.a)({},e)})),C(),a(!1),n._id===g.id&&t((function(e){return[].concat(Object(M.a)(e),[c])}))})),function(){y.off("joinChannel")}}),[]);return Object(c.useEffect)((function(){var e=function(e){!N.current.contains(e.target)&&!w.current.contains(e.target)&&a(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[s]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"px-4",children:Object(f.jsxs)("div",{className:"p-2 h-14 relative",ref:w,children:[Object(f.jsx)("label",{htmlFor:"search",className:"absolute text-white top-4 left-4 cursor-pointer",children:Object(f.jsx)(u.a,{icon:d.d})}),Object(f.jsx)("input",{id:"search",type:"search",autoComplete:"off",className:"focus:outline-none h-full w-full rounded-md p-1 pl-10 inputSearch leading-10 ctmFocus",placeholder:"Search",onFocus:function(){return a(!0),void C()}})]})}),Object(f.jsx)("div",{className:"relative w-full",children:Object(f.jsx)("div",{className:"absolute w-full px-4 overflow-hidden rounded-lg ".concat(s?"z-50":"z-index--1"),ref:N,children:Object(f.jsx)("ul",{className:"w-full bg-gray-500 rounded-lg transiton duration-200 ease-in-out opacity-0 overflow-hidden ".concat(s&&"opacity-100"),children:function(){var e=[];return m.map((function(t,n){e.push(Object(f.jsx)("li",{className:"w-full flex items-center ".concat(n!==m.length-1&&"border-b"," bg-gray-600 bg-opacity-70 transition duration-200 hover:bg-opacity-100"),children:Object(f.jsxs)("button",{className:"flex p-3 w-full ctmFocus items-center",onClick:function(){return function(e){var t={userID:g.id,channelID:e};y.emit("joinChannel",t)}(t._id)},children:[Object(f.jsx)("div",{className:"h-7 w-7 bg-red-400 rounded-md mr-4 flex items-center justify-center",children:t.name[0]}),Object(f.jsx)("span",{children:t.name})]})},t._id))})),e}()})})})]})}),B=function(e){return Object(f.jsxs)("div",{className:"shadow-lg h-16 flex-shrink-0 text-gray-100 font-bold text-lg px-6 flex items-center ".concat(e.className),children:[Object(f.jsx)("span",{children:e.title}),e.children]})},R=n(50),L=(n(286),function(e){var t=e.loading,n=e.channels,r=e.setChannels,s=Object(c.useState)(!1),a=Object(l.a)(s,2),u=a[0],d=a[1],j=Object(c.useContext)(h),x=j.user,m=j.setUser,O=Object(c.useState)(!1),p=Object(l.a)(O,2),g=(p[0],p[1]),v=Object(c.useState)(!1),N=Object(l.a)(v,2),w=(N[0],N[1]);Object(c.useContext)(_);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("button",{onClick:function(){return m((function(e){return e.notifications.push({icons:Object(f.jsx)(S.a,{}),color:"green-500",label:"Salut ceci est un test"}),Object(o.a)({},e)}))},children:"ADD NOTIF"}),Object(f.jsx)(D,{setIsOpenCreateChannel:w,isOpen:u,setIsOpen:d,channels:n,addChannel:r}),Object(f.jsx)(B,{title:"Channel",className:"justify-between",children:Object(f.jsx)("button",{onClick:function(){return d(!0)},className:"channelIcon p-1 rounded-md ctmFocus hoverMenuProfileBg",children:Object(f.jsx)(R.a,{className:"text-white"})})}),Object(f.jsx)(P,{setIsOpenJoinedChannel:g,channels:n,setChannels:r}),Object(f.jsx)("div",{className:"p-4 overflow-y-scroll scrollbar h-full",children:t?function(){for(var e=[],t=0;t<7;t++)e.push(Object(f.jsxs)("div",{className:"flex items-center mb-4 cursor-pointer w-full p-2 rounded-lg animate-pulse",children:[Object(f.jsx)("div",{className:"w-8 h-8 rounded-md bg-gray-400 mr-3"}),Object(f.jsx)("div",{className:"w-44 h-8 rounded-md bg-gray-400"})]},t));return e}():n.map((function(e,t){return Object(f.jsxs)("button",{onClick:function(){return function(e){m(Object(o.a)(Object(o.a)({},x),{},{currentChannel:e}));var t={userID:x.id,channelID:e._id};b.a.post("".concat(i,"channel/resetnotification"),t).then((function(e){r((function(t){var n=e.data,c=t.findIndex((function(e){return e._id===n._id}));return t[c]=n,Object(M.a)(t)}))})).catch((function(e){console.log("ERROR : "+e)}))}(e)},className:"flex items-center ".concat(t!==n.length-1&&"mb-4"," relative cursor-pointer w-full ctmFocus hoverMenuProfileBg p-2 rounded-lg"),children:[e.notifications.map((function(e,t){return 0!==e.notification&&e.userID===x.id&&Object(f.jsxs)("div",{className:"absolute h-6 w-6 bg-red-800 rounded-full flex items-center justify-center -left-1 -top-1 shadow-xl",children:[Object(f.jsx)("div",{className:"absolute z-0 animate-ping h-4/5 w-4/5 bg-red-800 rounded-full"}),Object(f.jsx)("span",{className:"text-white z-10 text-sha text-xs",children:e.notification>99?"99+":e.notification})]},t)})),Object(f.jsx)("div",{className:"w-8 h-8 channelIcon mr-3 rounded-md flex items-center justify-center text-white uppercase",children:e.name[0]}),Object(f.jsx)("span",{className:"text-gray-300 uppercase",children:e.name})]},e._id)}))})]})}),U=function(e){var t=e.children,n=e.isOpen,r=e.setIsOpen,s=e.left,a=e.top,l=e.right,i=e.bottom,o=Object(c.useRef)();return Object(c.useEffect)((function(){var e=n,t=function(t){o.current&&!o.current.contains(t.target)&&e&&r(!1)};return window.addEventListener("mousedown",t),function(){window.removeEventListener("mousedown",t)}}),[n]),Object(f.jsx)("div",{ref:o,style:{left:s||"unset",top:a||"unset",right:l||"unset",bottom:i||"unset"},className:"w-48 bg-black-700 absolute rounded-xl p-3 transition duration-200 opacity-0 transform ".concat(n?"scale-100 opacity-100":"scale-0 opacity-0"),children:Object(f.jsx)("ul",{className:"flex flex-col justify-evenly h-full text-left text-white",children:t})})},A=function(e){var t=e.children,n=e.bg,c=e.txt,r=e.click,s=e.className;return Object(f.jsx)("button",{className:"px-5 py-2 ".concat(n," ").concat(c," ").concat(s," m-2 ctmFocus transition duration-200 hover:bg-opacity-70 rounded"),onClick:r,children:t})},W=n(122),z=n(123),q=n(30),T=n(51),J=n(52),V=function(e){e.channels;var t=e.setChannels,n=Object(c.useContext)(_),r=Object(c.useState)(!1),s=Object(l.a)(r,2),a=s[0],u=s[1],d=Object(c.useState)(!1),j=Object(l.a)(d,2),x=j[0],m=j[1],O=Object(c.useState)(!1),p=Object(l.a)(O,2),g=p[0],v=p[1],N=Object(c.useState)(!1),w=Object(l.a)(N,2),y=w[0],C=w[1],I=Object(c.useState)([]),F=Object(l.a)(I,2),E=F[0],D=F[1],P=Object(c.useContext)(h),R=P.user,L=P.setUser;return Object(c.useEffect)((function(){return n.on("joinChannel",(function(e){var t=e.joinedUser,n=e.joinedChannel;R.currentChannel._id===n._id&&D((function(e){return[].concat(Object(M.a)(e),[t])}))})),n.on("banMember",(function(e){var t=e.bannedMember,n=e.channelID;t._id===R.id&&n===R.currentChannel._id&&m(!0),n===R.currentChannel._id&&D((function(e){return e.filter((function(e){return e._id!==t._id}))}))})),n.on("leaveChannel",(function(e){var n=e.leaveMember,c=e.channelID;L((function(e){return e.notifications.push({icons:Object(f.jsx)(S.a,{}),color:"green-500",label:"Channel leave"}),Object(o.a)({},e)})),n._id===R.id&&(t((function(e){return e.filter((function(e){return e._id!==c}))})),L(Object(o.a)(Object(o.a)({},R),{},{currentChannel:{}}))),c===R.currentChannel._id&&D((function(e){return e.filter((function(e){return e._id!==n._id}))}))})),b.a.get("".concat(i,"channel/user/").concat(R.currentChannel._id)).then((function(e){D(e.data)})),function(){n.off("joinChannel"),n.off("banMember"),n.off("leaveChannel")}}),[]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(k,{isOpen:x,setIsOpen:m,children:[Object(f.jsx)("h3",{children:"Your are banned from this channel"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(A,{click:function(){return L(Object(o.a)(Object(o.a)({},R),{},{currentChannel:{}}))},children:"Oh shit"}),Object(f.jsx)(A,{click:function(){return L(Object(o.a)(Object(o.a)({},R),{},{currentChannel:{}}))},children:"Nice"})]})]}),Object(f.jsx)(k,{isOpen:a,setIsOpen:u,text:"Are you sure you delete this channel?",children:Object(f.jsxs)("div",{className:"flex items-center justify-around",children:[Object(f.jsx)(A,{click:function(){return u(!1)},children:"Cancel"}),Object(f.jsx)(A,{className:"border border-red-500 hover:bg-red-500 hover:text-white",txt:"text-red-500",click:function(){n.emit("deleteChannel",R.currentChannel._id)},children:"Delete"})]})}),Object(f.jsx)(k,{isOpen:g,setIsOpen:v,text:"Are you sure you leave the channel?",children:Object(f.jsxs)("div",{className:"flex items-center justify-around",children:[Object(f.jsx)(A,{click:function(){return v(!1)},children:"Cancel"}),Object(f.jsx)(A,{className:"border border-red-500 hover:bg-red-500 hover:text-white",txt:"text-red-500",click:function(){return function(){var e={userID:R.id,channelID:R.currentChannel._id};n.emit("leaveChannel",e)}()},children:"Leave"})]})}),Object(f.jsxs)(B,{classNasme:"justify-start flex-shrink-0",children:[Object(f.jsx)("button",{className:"text-2xl ctmFocus mr-3",onClick:function(){return L(Object(o.a)(Object(o.a)({},R),{},{currentChannel:{}}))},children:Object(f.jsx)(W.a,{})}),Object(f.jsx)("span",{children:"All channels"})]}),Object(f.jsxs)("div",{className:"px-6 py-4",children:[Object(f.jsxs)("div",{className:"flex justify-between items-center mb-2 relative",children:[Object(f.jsx)("h3",{className:"uppercase text-gray-300 font-bold",children:R.currentChannel.name}),Object(f.jsx)("button",{className:"text-white text-2xl ctmFocus",onClick:function(){return C(!0)},children:Object(f.jsx)(T.a,{})}),Object(f.jsxs)(U,{isOpen:y,setIsOpen:C,top:"25px",right:"0",children:[Object(f.jsx)("li",{children:Object(f.jsxs)("button",{className:"w-full ctmFocus flex items-center text-gray-200 hoverMenuProfileBg p-2 rounded-lg",onClick:function(){return v(!0)},children:[Object(f.jsx)(z.a,{className:"mr-3"}),"LEAVE"]})}),Object(f.jsx)("li",{children:Object(f.jsxs)("button",{className:"w-full ctmFocus flex items-center hoverMenuProfileBg p-2 rounded-lg text-gray-200",onClick:function(){console.log("edit")},children:[Object(f.jsx)(q.b,{className:"mr-3"}),"EDIT"]})}),(R.id===R.currentChannel.owner||"admin"===R.role)&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("li",{className:"border-b border-gray-500 m-2"}),Object(f.jsx)("li",{children:Object(f.jsxs)("button",{className:"w-full ctmFocus flex items-center hoverMenuProfileBg p-2 rounded-lg text-red-500",onClick:function(){return u(!0)},children:[Object(f.jsx)(q.a,{className:"mr-3"}),"DELETE"]})})]})]})]}),Object(f.jsx)("p",{className:"text-gray-300",children:R.currentChannel.description?R.currentChannel.description:"no description"})]}),Object(f.jsx)("h3",{className:"uppercase text-gray-300 font-bold px-6 py-4",children:"Members"}),Object(f.jsx)("ul",{className:"overflow-y-scroll scrollbar h-full px-4",children:E.map((function(e,t){return Object(f.jsxs)("li",{className:"mb-4 flex justify-between",children:[Object(f.jsxs)("div",{className:"flex items-center p-2",children:[Object(f.jsx)("img",{className:"w-9 h-9  mr-5 rounded",src:i+e.picture,alt:"profile picture"}),Object(f.jsx)("span",{className:"text-lg ".concat(R.id===e._id?"text-gray-300":"text-gray-400"," font-bold"),children:e.pseudo}),e._id===R.currentChannel.owner&&Object(f.jsx)(q.d,{className:"ml-2 text-yellow-500"})]}),Object(f.jsxs)("div",{className:"flex items-center text-white",children:[Object(f.jsx)("button",{className:"ctmFocus p-1",children:Object(f.jsx)(q.c,{})}),(R.id===R.currentChannel.owner||"admin"===R.role)&&e._id!==R.id&&Object(f.jsx)("button",{className:"ml-4 ctmFocus p-1",onClick:function(){return function(e){var t={bannedMemberID:e,channelID:R.currentChannel._id};n.emit("banMember",t)}(e._id)},children:Object(f.jsx)(J.a,{})})]})]},t)}))})]})},H=function(e){var t=Object(c.useContext)(h),n=t.user,r=t.setUser,s=Object(c.useContext)(_),a=Object(c.useState)([]),u=Object(l.a)(a,2),d=u[0],j=u[1],x=Object(c.useState)(!1),m=Object(l.a)(x,2),O=m[0],p=m[1];return Object(c.useEffect)((function(){p(!0),b.a.get("".concat(i,"channel/").concat(n.id)).then((function(e){j(e.data),p(!1)})).finally((function(){p(!1)}))}),[]),Object(c.useEffect)((function(){return s.on("channelNotification",(function(e){j((function(t){var c=t.findIndex((function(t){return t._id===e._id}));if(-1===c)return t;var s=!1;if(r((function(t){return t.currentChannel._id===e._id&&(s=!0),t})),s){var a={userID:n.id,channelID:e._id};return b.a.post("".concat(i,"channel/resetnotification"),a),t[c].notifications.notification=0,Object(M.a)(t)}return t[c]=e,Object(M.a)(t)}))})),s.on("deleteChannel",(function(e){r((function(t){return t.notifications.push({icons:Object(f.jsx)(S.a,{}),color:"green-500",label:"Channel deleted"}),t.currentChannel._id!==e._id||(t.currentChannel={}),Object(o.a)({},t)})),j((function(t){return t.filter((function(t){return t._id!==e._id}))}))})),s.on("banMember",(function(e){var t=e.bannedMember,n=e.channelID,c=!1;r((function(e){return e.id===t._id&&(c=!0),Object(o.a)({},e)})),c&&j((function(e){return e.filter((function(e){return e._id!==n}))}))})),function(){s.off("channelNotification"),s.off("deleteChannel"),s.off("banMember")}}),[]),Object(f.jsx)(f.Fragment,{children:0!==Object.entries(n.currentChannel).length?Object(f.jsx)(V,{channels:d,setChannels:j}):Object(f.jsx)(L,{loading:O,channels:d,setChannels:j})})},G=function(e){return Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"border-b-2 h-16 border-gray-900 text-gray-100 font-bold text-lg px-6 flex items-center justify-between",children:Object(f.jsx)("h1",{className:"text-center text-white",children:"Message"})}),Object(f.jsx)("div",{className:"p-4",children:Object(f.jsxs)("button",{className:"flex items-center mb-4 cursor-pointer w-full ctmFocus hoverMenuProfileBg p-2 rounded-lg",children:[Object(f.jsx)("div",{className:"w-8 h-8 channelIcon mr-3 rounded-md flex items-center justify-center text-white"}),Object(f.jsx)("span",{className:"text-gray-300",children:"Message"})]})})]})},K=n(124),Y=function(e){var t=e.currentMode,n=e.setMode,r=Object(c.useContext)(h),s=r.user,a=r.setUser,j=Object(c.useState)(!1),m=Object(l.a)(j,2),O=m[0],p=m[1],g=Object(c.useState)(!1),v=Object(l.a)(g,2),N=v[0],w=v[1],y=Object(x.a)(),C=Object(l.a)(y,3)[2],I=Object(c.useState)(s.pseudo),M=Object(l.a)(I,2),F=M[0],E=M[1],_=Object(c.useState)(s.email),S=Object(l.a)(_,2),D=S[0],P=S[1],B=Object(c.useState)(""),L=Object(l.a)(B,2),A=L[0],W=L[1],z=Object(c.useState)(""),q=Object(l.a)(z,2),T=q[0],J=q[1],V=Object(c.useRef)();return Object(c.useEffect)((function(){O&&(E(s.pseudo),P(s.email))}),[N]),Object(f.jsxs)("div",{className:"w-72 h-full lg:w-10/12 bg-black-900 flex flex-col justify-between flex-shrink-0",children:[Object(f.jsxs)(k,{isOpen:N,setIsOpen:w,children:[Object(f.jsx)("span",{className:"font-bold text-xl block text-center mb-4 text-gray-300",children:"My Profil"}),Object(f.jsxs)("form",{ref:V,className:"flex",children:[Object(f.jsxs)("div",{className:"flex flex-col items-center mr-4 text-gray-300",children:[Object(f.jsx)("img",{className:"h-44 w-44 ",src:T||s.picture}),Object(f.jsx)("label",{htmlFor:"profilpicture",className:"cursor-pointer border border-gray-300 py-1 w-full text-center ctmFocus text-gray-300 hover:bg-gray-900",children:"Change"}),Object(f.jsx)("input",{id:"profilpicture",type:"file",hidden:!0,onChange:function(e){W(e.target.files[0]);var t=URL.createObjectURL(e.target.files[0]);J(t)},accept:"image/png , image/jpeg, image/jpg"})]}),Object(f.jsxs)("div",{className:"flex flex-col justify-between",children:[Object(f.jsx)("input",{onChange:function(e){return E(e.target.value)},spellCheck:"false",type:"text",className:"border border-gray-500 bg-transparent px-4 py-2 ctmFocus block text-gray-300",value:F}),Object(f.jsx)("input",{onChange:function(e){return P(e.target.value)},spellCheck:"false",type:"email",className:"border border-gray-500 bg-transparent px-4 py-2 ctmFocus block text-gray-300",value:D}),Object(f.jsx)("a",{href:"#",className:"cursor-pointer border border-gray-300 py-1 w-full text-center ctmFocus text-gray-300 hover:bg-gray-900",children:"Change Password"})]})]}),Object(f.jsx)("button",{className:"w-full py-2 bg-blue-700 mt-4 ctmFocus font-semibold hover:bg-blue-800",onClick:function(){return function(e){var t=new FormData;t.append("pseudo",F),t.append("picture",A),t.append("userID",s.id),b.a.post("".concat(i,"user/uploadprofilpicture"),t).then((function(e){console.log(e),a(Object(o.a)(Object(o.a)({},s),{},{picture:"".concat(i).concat(e.data)}))}))}()},children:"Save"})]}),Object(f.jsx)(f.Fragment,{children:"channel"===t?Object(f.jsx)(H,{}):Object(f.jsx)(G,{})}),Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{className:"h-14 bg-gray-700 flex",children:[Object(f.jsx)("button",{className:"px-6 w-full text-gray-300 ctmFocus hover:bg-gray-800",onClick:function(){return n("channel")},children:"CHANNEL"}),Object(f.jsx)("button",{className:"px-6 w-full text-gray-300 ctmFocus hover:bg-gray-800",onClick:function(){return n("message")},children:"MESSAGE"})]}),Object(f.jsxs)("a",{href:"#",className:"h-20 bg-black-1100 p-6 flex items-center justify-between w-full ctmFocus ring-inset relative",onClick:function(e){e.preventDefault(),p(!0)},children:[Object(f.jsxs)(U,{isOpen:O,setIsOpen:p,top:"-144px",right:"16px",children:[Object(f.jsx)("li",{children:Object(f.jsxs)("button",{className:"flex w-full transition duration-200 hoverMenuProfileBg rounded-lg p-2 items-center ctmFocus",onClick:function(){return w(!0)},children:[Object(f.jsx)(u.a,{className:"text-xl mr-3",icon:d.f}),"My Profile"]})}),Object(f.jsx)("li",{children:Object(f.jsxs)("button",{className:"flex w-full transition duration-200 hoverMenuProfileBg rounded-lg p-2 items-center ctmFocus",children:[Object(f.jsx)(K.a,{className:"text-xl mr-3"}),"Tweeter"]})}),Object(f.jsx)("li",{className:"h-1 border-b border-gray-100 my-2 opacity-30"}),Object(f.jsx)("li",{children:Object(f.jsxs)("button",{className:"flex w-full text-red-500 transition duration-200 hoverMenuProfileBg rounded-lg p-2 items-center ctmFocus",onClick:function(){C(["REMEMBER_ME"]),window.location.reload()},children:[Object(f.jsx)(R.b,{className:"text-xl mr-3"}),"Logout"]})})]}),Object(f.jsxs)("div",{className:"flex items-center",children:[Object(f.jsx)("img",{className:"h-10 w-10 mr-5",src:s.picture,alt:"your profile picture"}),Object(f.jsx)("span",{className:"text-gray-300 text-xl",children:s.pseudo})]}),Object(f.jsx)(u.a,{className:"text-gray-300",icon:d.a})]})]})]})},Q=function(e){var t=e.currentMode,n=e.setMode,c=e.isOpenBurgerMenu,r=e.setIsOpenBurgerMenu;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(I.a,{minWidth:"1024px",children:Object(f.jsx)(Y,{currentMode:t,setMode:n})}),Object(f.jsx)(I.a,{maxWidth:"1023px",children:Object(f.jsxs)("div",{className:"w-72 lg:flex lg:flex-shrink-0 lg:h-full lg:w-full lg:z-50 lg:transition lg:duration-200 ease lg:absolute transform  ".concat(c?"lg:translate-x-0":"lg:-translate-x-full"),children:[Object(f.jsx)(Y,{currentMode:t,setMode:n}),c&&Object(f.jsx)("div",{className:"flex justify-center w-2/12 bg-black bg-opacity-30",onClick:function(){return r(!1)},children:Object(f.jsx)("button",{className:"h-9 w-9 bg-black-1100 z-50 right-10 mt-3 flex items-center justify-center rounded-lg ctmFocus",onClick:function(){return r(!1)},children:Object(f.jsx)(y.a,{className:"text-white"})})})]})})]})},X=n(126),Z=(n(287),function(e){var t=e.user,n=e.message,c=e.date,r=e.hour;return Object(f.jsxs)("li",{className:"flex mb-4 w-full",children:[Object(f.jsx)("img",{className:"h-10 w-10 bg-white rounded-md mr-5 mt-1 flex-none",src:"".concat(i).concat(t.picture),alt:"C"}),Object(f.jsxs)("div",{className:"w-full",children:[Object(f.jsxs)("div",{className:"flex items-baseline",children:[Object(f.jsx)("h2",{className:"mr-3 font-bold text-lg colorName",children:t.pseudo}),Object(f.jsx)("span",{className:"text-gray-300 text-xs colorName",children:function(){for(var e=c.split("/"),t=(new Date).toLocaleDateString().split("/"),n=0;n<=2;n++)e[n]=parseInt(e[n]),t[n]=parseInt(t[n]);if(e[1]===t[1]&&e[2]===t[2]){if(e[0]===t[0])return"today at ";if(e[0]===t[0]-1)return"yesterday at "}return c}()+" "+r})]}),Object(f.jsx)("div",{className:"text-gray-300 w-full",children:n})]})]})}),$=function(e){var t=e.date,n=function(){var e=("0"===t.slice(3,5)[0])-1?t.slice(3,5)-1:t.slice(4,5)-1;return"".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][e]," ").concat(t.slice(0,2),", ").concat(t.slice(6,10))};return n(),Object(f.jsxs)("li",{className:"flex justify-between items-center mb-4",children:[Object(f.jsx)("div",{className:"border-b border-gray-500 w-full"}),Object(f.jsx)("span",{className:"inline-block flex-shrink-0 text-center break-normal mx-4 text-gray-500 text-xs",children:n()}),Object(f.jsx)("div",{className:"border-b border-gray-500 bg-gray-500 w-full"})]})},ee=function(e){var t=e.setIsOpenBurgerMenu,n=Object(c.useContext)(h).user,r=Object(c.useState)([]),s=Object(l.a)(r,2),a=s[0],u=s[1],d=Object(c.useRef)(),j=Object(c.useContext)(_);Object(c.useEffect)((function(){j.on("sendMessage",(function(e){-1===a.findIndex((function(t){return t._id!==e._id}))&&u((function(t){return[].concat(Object(M.a)(t),[e])}))}))}),[]),Object(c.useEffect)((function(){b.a.get("".concat(i,"channel/message/").concat(n.currentChannel._id)).then((function(e){u(e.data)}))}),[]);var x=function(){var e=d.current.innerText;if(e){var t={userID:n.id,channelID:n.currentChannel._id,message:e};d.current.innerText="",j.emit("sendMessage",t),j.emit("channelNotification",n.currentChannel._id)}};return Object(f.jsxs)("div",{className:"flex flex-col h-full w-full justify-between",children:[Object(f.jsxs)("div",{className:"h-16 shadow-lg text-gray-100 font-bold text-lg px-11 lg:px-8 flex items-center uppercase flex-shrink-0",children:[Object(f.jsx)(I.a,{maxWidth:"1023px",children:Object(f.jsx)("button",{className:"mr-6 ctmFocus p-2",onClick:function(){return t(!0)},children:Object(f.jsx)(X.a,{})})}),Object(f.jsx)("h1",{children:0!==Object.entries(n.currentChannel).length?n.currentChannel.name:"Select channel"})]}),0!==Object.entries(n.currentChannel).length?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("div",{className:"overflow-y-scroll h-full scrollbar flex flex-col-reverse",children:Object(f.jsx)("ul",{className:"px-11 pt-6 lg:px-8 break-all mt-auto",children:function(){var e=[],t=a.filter((function(e){return e.channelID===n.currentChannel._id})).map((function(e){return e.date.slice(0,2)})),c=a.filter((function(e){return e.channelID===n.currentChannel._id})).map((function(e){return e.date.slice(3,5)})),r=a.filter((function(e){return e.channelID===n.currentChannel._id})).map((function(e){return e.date.slice(6,10)})),s=t[0],l=c[0],i=r[0];return a.filter((function(e){return e.channelID===n.currentChannel._id})).forEach((function(n,a){var u=n.date.slice(0,2),d=n.date.slice(3,5),j=n.date.slice(6,10);u===s&&d===l&&j===i||(e.push(Object(f.jsx)($,{date:n.date},a)),s=t[a],l=c[a],i=r[a]),e.push(Object(f.jsx)(Z,Object(o.a)({},n),n._id))})),e}()})}),Object(f.jsxs)("div",{className:"min-h-10 max-w-full mx-11 lg:mx-8 flex relative rounded-md overflow-hidden my-7 flex-shrink-0",children:[Object(f.jsx)("div",{contentEditable:"true",ref:d,onKeyDown:function(e){return function(e){13===e.keyCode&&(e.preventDefault(),x())}(e)},className:"h-full w-full inputSearch ctmFocus p-2 pr-10 break-all text-gray-300"}),Object(f.jsx)("button",{onClick:function(){x()},className:"absolute right-1 inset-y-1 ctmFocus m-auto bg-blue-500  text-white h-8 w-8 flex items-center justify-center rounded-md cursor-pointer",children:Object(f.jsx)(J.b,{})})]})]}):Object(f.jsxs)("div",{className:"flex items-center justify-center flex-col h-full",children:[Object(f.jsx)("h3",{className:"text-4xl",children:"Welcome !"}),Object(f.jsx)("p",{children:"Please select channel"})]})]})},te=function(e){return Object(f.jsx)("div",{children:Object(f.jsx)("h1",{children:"Message"})})},ne=function(e){var t=Object(c.useState)("channel"),n=Object(l.a)(t,2),r=n[0],s=n[1],a=Object(c.useState)(""),i=Object(l.a)(a,2),u=i[0],d=(i[1],Object(c.useState)(!1)),j=Object(l.a)(d,2),b=j[0],x=j[1],m=Object(c.useContext)(h),O=(m.user,m.setUser);return Object(c.useEffect)((function(){O((function(e){return e.notifications.push({icons:Object(f.jsx)(T.b,{}),color:"blue-500",label:"Welcome ".concat(e.pseudo)}),Object(o.a)({},e)}))}),[]),Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"w-full h-full bg-black-700 shadow-2xl flex overflow-hidden relative",children:[Object(f.jsx)(Q,{isOpenBurgerMenu:b,setIsOpenBurgerMenu:x,currentMode:r,setMode:s}),function(){switch(r){case"channel":return Object(f.jsx)(ee,{setIsOpenBurgerMenu:x,currentChannel:u});case"message":return Object(f.jsx)(te,{});default:return Object(f.jsx)(ee,{setIsOpenBurgerMenu:x,currentChannel:u})}}()]})})},ce=n(291),re=function(e){var t=Object(c.useContext)(h),n=t.user,r=t.setUser;return Object(c.useEffect)((function(){0!==n.notifications.length&&(setTimeout((function(){r((function(e){return e.notifications.shift(),Object(o.a)({},e)}))}),4e3),clearTimeout(),console.log("new notif"))}),[n]),Object(f.jsx)("ul",{style:{zIndex:9999},className:"absolute top-0 left-1/2 transform -translate-x-1/2",children:n.notifications.map((function(e,t){var n=e.icons,c=e.label,r=e.color;return Object(f.jsx)(N,{icons:n,label:c,color:r},Object(ce.a)())}))})},se={id:null,pseudo:null,email:null,description:null,picture:null,role:null,isConnected:!1,currentChannel:{},notifications:[]},ae=function(e){var t=Object(c.useState)(se),n=Object(l.a)(t,2),r=n[0],s=n[1],a=Object(x.a)(),o=Object(l.a)(a,3),u=o[1],d=o[2];return Object(c.useEffect)((function(){b.a.get("".concat(i,"user/rememberme"),{withCredentials:!0}).then((function(e){if(""===e.data)throw new Error;s({id:e.data._id,pseudo:e.data.pseudo,email:e.data.email,description:e.data.description,picture:i+e.data.picture,role:e.data.role,isConnected:!0,currentChannel:{},notifications:[]}),u(["REMEMBER_ME"],e.data.remember_me_token)})).catch((function(e){s(se),d(["REMEMBER_ME"])}))}),[]),Object(f.jsx)("div",{className:"h-screen flex justify-center items-center bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900",children:Object(f.jsx)(_.Provider,{value:E,children:Object(f.jsxs)(h.Provider,{value:{user:r,setUser:s},children:[Object(f.jsx)(re,{}),r.isConnected?Object(f.jsx)(ne,{}):Object(f.jsx)(w,{})]})})})};a.a.render(Object(f.jsx)(ae,{}),document.querySelector("#root"))}},[[288,1,2]]]);
//# sourceMappingURL=main.f29670c6.chunk.js.map